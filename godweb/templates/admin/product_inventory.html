{% extends 'base.html' %}

{% block title %}Kho sản phẩm - GodWeb{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="sidebar">
        <div style="padding: 20px 25px; border-bottom: 1px solid var(--border-color);">
            <h3 style="color: var(--primary-color);"><i class="fas fa-cog"></i> Admin Panel</h3>
        </div>
        <div class="sidebar-menu">
            <a href="{{ url_for('admin.dashboard') }}"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <a href="{{ url_for('admin.users') }}"><i class="fas fa-users"></i> Người dùng</a>
            <a href="{{ url_for('admin.categories') }}"><i class="fas fa-folder"></i> Danh mục</a>
            <a href="{{ url_for('admin.posts') }}"><i class="fas fa-newspaper"></i> Bài viết</a>
            <a href="{{ url_for('admin.products') }}" class="active"><i class="fas fa-box"></i> Sản phẩm</a>
            <a href="{{ url_for('admin.topups') }}"><i class="fas fa-coins"></i> Yêu cầu nạp</a>
            <a href="{{ url_for('admin.transactions') }}"><i class="fas fa-history"></i> Giao dịch</a>
            <a href="{{ url_for('admin.orders') }}"><i class="fas fa-shopping-cart"></i> Đơn hàng</a>
            <a href="{{ url_for('main.home') }}"><i class="fas fa-home"></i> Về trang chủ</a>
        </div>
    </div>

    <div class="dashboard-content">
        <div class="flex-between" style="margin-bottom: 30px;">
            <h2><i class="fas fa-warehouse"></i> Kho: {{ product.name }}</h2>
            <a href="{{ url_for('admin.products') }}" class="btn btn-outline"><i class="fas fa-arrow-left"></i> Quay lại</a>
        </div>

        <!-- Upload file txt -->
        <div class="card" style="padding: 25px; margin-bottom: 30px;">
            <h3 style="margin-bottom: 20px;"><i class="fas fa-upload"></i> Upload file tài khoản</h3>
            <form method="POST" enctype="multipart/form-data">
                <div class="form-group">
                    <label class="form-label">File tài khoản (.txt)</label>
                    <input type="file" name="inventory_file" class="form-control" accept=".txt" required>
                    <p style="font-size: 14px; color: var(--text-light); margin-top: 5px;">
                        <i class="fas fa-info-circle"></i> Mỗi dòng là một tài khoản. File sẽ được lưu và cập nhật khi có người mua.
                    </p>
                </div>
                <button type="submit" class="btn btn-primary"><i class="fas fa-upload"></i> Upload</button>
            </form>
        </div>

        <!-- File info -->
        <div class="card" style="padding: 25px;">
            <h3 style="margin-bottom: 20px;"><i class="fas fa-file-alt"></i> Thông tin kho hàng</h3>

            {% if product.inventory_file %}
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px;">
                <div class="stat-card">
                    <h3><i class="fas fa-file"></i> File</h3>
                    <div class="value" style="font-size: 16px; word-break: break-all;">{{ product.inventory_file }}</div>
                </div>
                <div class="stat-card primary">
                    <h3><i class="fas fa-box"></i> Còn lại</h3>
                    <div class="value">{{ product.stock }}</div>
                </div>
                <div class="stat-card">
                    <h3><i class="fas fa-shopping-cart"></i> Đã bán</h3>
                    <div class="value">{{ product.sold_count or 0 }}</div>
                </div>
            </div>

            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <a href="{{ url_for('admin.view_inventory_file', product_id=product.id) }}" class="btn btn-primary" target="_blank">
                    <i class="fas fa-eye"></i> Xem nội dung file
                </a>
                <a href="{{ url_for('admin.download_inventory_file', product_id=product.id) }}" class="btn btn-secondary">
                    <i class="fas fa-download"></i> Tải file xuống
                </a>
            </div>
            {% else %}
            <div class="empty-state" style="padding: 40px;">
                <i class="fas fa-file-upload" style="font-size: 50px; color: var(--text-light);"></i>
                <h3 style="margin-top: 15px;">Chưa có file tài khoản</h3>
                <p>Upload file .txt để bắt đầu bán sản phẩm này</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
